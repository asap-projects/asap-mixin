
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Understand the project structure &#8212; Project: mixin</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Project: mixin</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../changelog.html">
   Changelog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../version.html">
   Version
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/asap-projects/asap-mixin"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/asap-projects/asap-mixin/issues/new?title=Issue%20on%20page%20%2Fgetting-started/structure.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/getting-started/structure.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-architecture-the-module-viewtype">
   Software Architecture: The Module Viewtype
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-layout">
   Project Layout
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-layout-of-a-c-source-module">
   General Layout of a C++ source Module
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Understand the project structure</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-architecture-the-module-viewtype">
   Software Architecture: The Module Viewtype
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-layout">
   Project Layout
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-layout-of-a-c-source-module">
   General Layout of a C++ source Module
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="understand-the-project-structure">
<span id="project-structure"></span><h1>Understand the project structure<a class="headerlink" href="#understand-the-project-structure" title="Permalink to this headline">#</a></h1>
<p>Last Updated on 2022-04-03</p>
<p>Compared to other languages such JavaScript, Java or Rust, C++ seriously lacks
built-in capabilities for defining, building and using modules. Many competing
approaches exist such as <a class="reference external" href="https://conan.io/">Conan</a>, <a class="reference external" href="https://vcpkg.io/">vcpkg</a>, <a class="reference external" href="https://github.com/cpp-pm/hunter">Hunter</a>, etc. None
of them completely solves the problem and the worst part is that they often are
mutually exclusive.</p>
<p>The choices made in the <cite>asap</cite> starter project with regard to the project layout
and to how modules (internal and 3rd party) are integrated and managed do not
exclude the use of package managers or lock you down to one approach or another.</p>
<p>The emphasis is put on a clean and extensible project layout and a build system
that stays as much as possible within the commonly used things in CMake.</p>
<section id="software-architecture-the-module-viewtype">
<h2>Software Architecture: The Module Viewtype <a class="footnote-reference brackets" href="#f1" id="id1">1</a><a class="headerlink" href="#software-architecture-the-module-viewtype" title="Permalink to this headline">#</a></h2>
<p>Decomposing a system into manageable units remains one of the most common ways
to think about the structure of the system. Often, it also determines how a
system’s source code is partitioned into separate parts, what kind of interfaces
exist between these parts and how these parts are aggregated into larger
ensembles.</p>
<p>In the context of <cite>asap</cite> we adopt a broad definition of the <cite>module</cite> concept as
an implementation unit of software that provides a coherent unit of
functionality. Because we are dealing specifically with C++ development, that
implementation unit will be a set of C++ files, configuration files, static data
files, etc. In addition to that,we also deal with documentation files, and
various build scripts, including CMake and other tools.</p>
<p>Modules can be related to each others in different ways:</p>
<ul class="simple">
<li><p><strong>A is part of B</strong>: this type of relation can indicate simple aggregation,
such as when a module is included into one or many others, or could indicate a
more sophisticated decomposition relationship.</p></li>
<li><p><strong>A depends on B</strong>: this relation can take several forms such as uses,
allowed-to-use, sends-data-to, transfers-control-to, and so forth.</p></li>
<li><p><strong>A is a B</strong>: this one defines a generalization relationship and in general
would not impact the macro-level structure of the project. We do however use
it in this starter project to define library and executable modules for which
we provide generic reusable CMake build scripts that can be simply extended.</p></li>
</ul>
<p>To the maximum possible extent we want to preserve and faithfully map the
modules and their relations in the software architecture to the development
infrastructure. Implementing a module always results in many separate files,
such as those that contain the source code, files that have to be included and
usually contain definitions, files that describe how to build an executable, and
files that are the result of translating, or compiling, the module. Those files
need to be organized so as not to lose control and integrity of the system.
Configuration management techniques usually do this job: in the simplest case, a
hierarchy of directories in a file system.</p>
<p>Assuming this starter project is used to build a simple application that reads
and writes files on the local filesystem, a representation of the application
architecture in a module decomposition view would look like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────────────────────────────────────────────┐
│ ASAP Application                                                │
│  (System)                                                       │
│  ┌─────────────────────┐                          ┌──────────┐  │
│  │                     ├──────────────────────────►          │  │
│  │                     │                          │          │  │
│  │                     │  ┌───────────────────┐   │          │  │
│  │                     │  │                   │   │          │  │
│  │                     │  │ logging framework │   │          │  │
│  │                     │  │                   │   │          │  │
│  │                     │  │               3PM │   │          │  │
│  │                     │  └───────────▲───────┘   │          │  │
│  │                     │              │           │          │  │
│  │       Main          │              │           │          │  │
│  │                     │  ┌───────────┴───────┐   │          │  │
│  │    Application      │  │  common           │   │          │  │
│  │                     │  │                   │   │          │  │
│  │       Module        │  │                   │   │          │  │
│  │                     ├──►                   ├───►          │  │
│  │                     │  │                   │   │   unit   │  │
│  │                     │  │                   │   │          │  │
│  │                     │  └───▲───────────────┘   │  testing │  │
│  │                     │      │                   │          │  │
│  │                     │  ┌───┴───────────────┐   │ framework│  │
│  │                     │  │                   │   │          │  │
│  │                     ├──►  other module     ├───►          │  │
│  │                     │  │                   │   │          │  │
│  │                     │  │                   │   │      3PM │  │
│  └─────────────────────┘  └───────────────────┘   └──────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
</pre></div>
</div>
<div class="margin admonition note">
<p class="admonition-title">Note</p>
<p>Composition is allowed at any depth within the structure of an <cite>asap</cite> based
project. Often, it is implemented using a <cite>git</cite> submodule.</p>
</div>
<p>The arrow in the diagram above mainly refer to a uses relationship. Notice how
the modules can be 3rd party modules (indicated with a <cite>3PM</cite> sticker), provided
by <cite>asap</cite> as reusable components or specifically made for the application.</p>
<p>The <cite>Unit Testing Framework</cite> is extensively used in the project but only during
development. It won’t be part of the final application package for deployment
for instance. Such modules exist within the project and the CMake build system
can clear make the difference between the artifacts intended for use during
development only vs. the ones destined for deployment.</p>
</section>
<section id="project-layout">
<h2>Project Layout<a class="headerlink" href="#project-layout" title="Permalink to this headline">#</a></h2>
<p>Based on the module decomposition view above, we now can look at how this
translates into the hierarchy of directories forming the <cite>asap</cite> project layout.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>.
├── &lt;.git&gt;                          I
├── &lt;.sphinx&gt;
├── &lt;build&gt;
│   ----------------------------------------
├── &lt;.github&gt;
├── &lt;.husky&gt;
├── &lt;.vscode&gt;
├── &lt;doxygen&gt;                       II
├── .clang-format
├── .clang-tidy
├── .commitlintrc.json
├── .gitattributes
├── .gitignore
├── .gitmodules
├── .runsettings
├── .versionrc.json
├── requirements.txt
│   ----------------------------------------
├── &lt;doc&gt;                           III
│   ----------------------------------------
├── &lt;deploy&gt;                        IV
│   ----------------------------------------
├── &lt;data&gt;                          V
│   ----------------------------------------
├── &lt;templates&gt;                     VI
│   ----------------------------------------
├── &lt;common&gt;
├── &lt;filesystem&gt;
├── &lt;third_party&gt;                   VII
│   ├── &lt;fmt&gt;
│   ├── &lt;spdlog&gt;
│   └── CMakeLists.txt
│   ----------------------------------------
├── &lt;cmake&gt;
├── CMakeLists.txt                  VIII
├── asap-config.cmake
│   ----------------------------------------
├── AUTHORS
├── LICENSE                          IX
├── README.md
└── CHANGELOG.md
</pre></div>
</div>
<p>The above diagram shows a typical layout with directories and files of a startup
project based on asap. The actual files and directories will of course differ
from project to project based on how you customize it to add or remove things
from the starting state.</p>
<p>The files and directories have been grouped into clusters based on their common
purpose. We’ll explain what each cluster role is and what are the important
directories and files it contains.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Part</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>I</p></td>
<td><p>Transient directories created by the various tools used during the
development. Items other than the <cite>.git</cite> directory will not be present
when the project is freshly cloned. The <cite>.sphinx</cite> directory holds the
python virtual env used for the documentation generation. The <cite>build</cite>
directory is where the <cite>cmake</cite> build will happen and all build artifacts
will be located.</p></td>
</tr>
<tr class="row-odd"><td><p>II</p></td>
<td><p>Various files used to configure and customize the behavior of tools used
in the development. Their usage will be explained in the corresponding
sections of the documentation.</p></td>
</tr>
<tr class="row-even"><td><p>III</p></td>
<td><p>This is where all project documentation resides. The documentation system
primarily uses <cite>sphinx</cite> and <cite>restructuredText</cite> but occasionally markdown
files can also be used. Maintaining the project documentation is an
important task which will be thoroughly explained separately.</p></td>
</tr>
<tr class="row-odd"><td><p>IV</p></td>
<td><p>This directory holds data and configuration files required to build the
final deployable package of the project artifacts. These packages are
often operating system dependent.</p></td>
</tr>
<tr class="row-even"><td><p>V</p></td>
<td><p>This directory is intentionally present in the starter project even if no
data is inside to emphasize the best practice of separating application
data from code, configuration, etc… Use this place to store static data
files that need to be deployed with the system.</p></td>
</tr>
<tr class="row-odd"><td><p>VI</p></td>
<td><p>System wide templates used during the build to generate other files. If a
template is only used within a specific module, place it within its
corresponding module.</p></td>
</tr>
<tr class="row-even"><td><p>VII</p></td>
<td><p>The various modules in the system. Third party libraries are preferably
placed under the <cite>third_party</cite> directory for clear demarcation of what is
coming from outside the project. Sometimes, it is more natural or
practical to embed the third party code directly within the source code of
a system module (e.g. this is how Hedley is included inside the <cite>common</cite>
module).</p></td>
</tr>
<tr class="row-odd"><td><p>VIII</p></td>
<td><p>The CMakeLists.txt and supported scripts which are used to build the
system deployable artifacts from source code. Customization of the starter
project build to suit the real project happens primarily in the
<cite>CMakeLists.txt</cite> and <cite>asap-config.cmake</cite> files. All files under the
<cite>cmake</cite> directory are generic reusable scripts and, in general, should not
be modified.</p></td>
</tr>
<tr class="row-even"><td><p>IX</p></td>
<td><p>Various meta-information files present in each project repository. Adapt
the contents as needed to suit your project, keeping in mind the
<cite>CHANGELOG.md</cite> can be automatically maintained as described in this
documentation.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="general-layout-of-a-c-source-module">
<h2>General Layout of a C++ source Module<a class="headerlink" href="#general-layout-of-a-c-source-module" title="Permalink to this headline">#</a></h2>
<p>Since we are heavily using the system decomposition into modules as an
architectural principle, we’ll be creating a lot of these modules and therefore
we need to be consistent and efficient in how we layout the source code
artifacts inside each one of them.</p>
<p>I have looked at so many OpenSource projects, coding standards, recommended
project layouts,… for inspiration and while there is no holy grail for this
problem, a few best practices have emerged:</p>
<ul class="simple">
<li><p>separate test code from the module functional code. That way, it is clear
which files contribute to build the module deployable artifacts vs. testing
artifacts.</p></li>
<li><p>we’re doing C++, so we have interface files (.h) and implementation files
(.cpp) and while there is no consensus on where to put them, I have found
that it is much simpler and cleaner to keep them each in its own directory.
With modern editors, we don’t navigate code anymore based on the file browser.
We use intellisense.</p></li>
<li><p>inside the <cite>include</cite> directory, repeat the module name so that when we include
files from this module we say <cite>#include &lt;module/foo.h&gt;</cite> and not <cite>&lt;foo.h&gt;</cite>.
In coding, explicit intents are much safer than implicit intents.</p></li>
<li><p>in-house developed modules containing C++ code are much easier reused in their
source code form than in any other form. Unfortunately C++ package managers
are still far from mature. Therefore, we keep each module in its own git
repository and we embed it as a submodule when reused.</p></li>
<li><p>building a module should be descriptive. The build logic and complexity should
already be managed at the system level. We just need to describe a module to
get it included in the system. That description is in the module’s
<cite>CMakeLists.txt</cite> which almost does not contain any scripted logic.</p></li>
<li><p>each module should be properly documented. The system documentation build will
ensure modules can be referred to and get integrated into the overall
documentation.</p></li>
</ul>
<p>With these in mind, the layout of each module looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>│   .gitignore
│   .gitmodules
│   AUTHORS
│   CMakeLists.txt
│   LICENSE
│   README.md
│
├───doc
│
├───include
│   ├───common
│   │   └───traits
│   └───contracts
│
├───src
│
└───test
</pre></div>
</div>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>An excellent book on this topic is <a class="reference external" href="https://www.amazon.com/Documenting-Software-Architectures-Views-Beyond/dp/0201703726/ref=sr_1_1?_encoding=UTF-8&amp;camp=212361&amp;creative=380601&amp;dchild=1&amp;keywords=0201703726&amp;link_code=wql&amp;qid=1635883655&amp;s=books&amp;sr=1-1">Documenting Software Architectures:
Views and Beyond</a>
(available on Amazon, or just Google it).</p>
</dd>
</dl>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2022, The Authors.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>